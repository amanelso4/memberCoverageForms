<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body>
<form *ngIf="(form | async) || newForm; else loading" [formGroup]="model" (ngSubmit)="submit()">
  <div class="container-fluid">
    <div [hidden]="submitted">

      <h3>Form Submission</h3>
      <div class="row">
        <br> <br>
        <div class="col-lg-4">
          <div class="container">
            <div class="row">
              <div class="col-lg-4">
                <label for="formType">Form type: </label> <br>
              </div>
              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" required formControlName="formType">
                    <option *ngFor="let fType of formTypes" [value]="fType">{{fType}}</option>
                  </select>
                  <!--<div [hidden]="formType.valid || formType.untouched" class="alert alert-danger">
                      Form type is required
                    </div>-->
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-lg-4">
                <label for="coverageType">Coverage Type: </label>
              </div>

              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" id="coverageType" required formControlName="coverageType"
                          name="coverageType">
                    <option *ngFor="let coverageType of coverageTypes" [value]="coverageType">{{coverageType}}
                    </option>
                  </select>
                  <!--<div [hidden]="coverageType.valid || coverageType.untouched" class="alert alert-danger">
                      Coverage Type is required
                    </div>-->
                </div>
              </div>
            </div>
            <div class="row">
              <div class="col-lg-4">
                <label for="state">Coverage State(s): </label>
              </div>
              <div class="col-lg-8">
                <div class="form-group">

                  <!--<ng-multiselect-dropdown [placeholder]="'States'" [data]="states" formControlName="state"
                                           [settings]="dropdownSettings" (onSelect)="updateState()"
                                           (onSelectAll)="onSelectAll()"
                                           (onDeSelect)="updateState()" (onDeSelectAll)="onDeSelectAll()" name="state"
                                           id="state">
                  </ng-multiselect-dropdown>-->
                  <select multiple formControlName="state" class="form-control" id="state" required style="height: auto" name="state">
                    <option *ngFor="let state of states" [value]="state">{{ state }}</option>
                  </select>

                </div>
              </div>

            </div>
            <div class="row">
              <div class="col-lg-4">
                <label for="sourceSystem">Source System: </label>
              </div>
              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" id="sourceSystem" required formControlName="sourceSystem" name="state">
                    <option *ngFor="let sourceSystem of sourceSystems" [value]="sourceSystem">{{sourceSystem}}
                    </option>
                  </select>
                  <!--<div [hidden]="sourceSystem.valid || sourceSystem.untouched" class="alert alert-danger">
                      Source System is required
                    </div>-->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-4" style="background-color:white;">

          <div class="row">
            <div class="col-lg-4">
              <label for="name">Form Name: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="name" required formControlName="name" name="name">
                <!--<div [hidden]="name.valid || name.untouched" class="alert alert-danger">Name is required
              </div>-->
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-4">
              <label for="formId">Form ID: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="formId" required formControlName="formId" name="formId">
                <!--<div [hidden]="formId.valid || formId.untouched" class="alert alert-danger">Form ID is required
              </div>-->
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-4">
              <label for="link">Form Link: </label>
              <button class="button button--primary-yellow" type="button" (click)="view=true; easterEgg(model.value.name)">View Form</button>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="link" required formControlName="link" name="link">
                <!--<div [hidden]="link.valid || link.untouched" class="alert alert-danger">Link is required
              </div>-->
              </div>
            </div>
          </div>
          <br>

          <div class="row">
            <div class="col-lg-4">
              <label for="description">Form Description: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="description" required formControlName="description"
                       name="description">
                <!--<div [hidden]="description.valid || description.untouched" class="alert alert-danger">Description is
                required
              </div>-->
              </div>
            </div>
            <div [hidden]="!egg">
              Hello there my friend, this is amanda.x.nelson. I like to computer program and I am an intern at Sun Life.
              I made this app. This is my EasterEgg. Like it? I bet you do.
            </div>

          </div>

        </div>

        <div class="col-lg-4" style="background-color:white;">
          <div class="container">
            <div [hidden]="!view">
              <style class="'pdf'" , height="100px"></style>
              <pdf-viewer
                [class]="'pdf'"
                [src]="'https://cors-anywhere.herokuapp.com/' + model.value.link"
                [show-all]="false"
                [original-size]="false"
                [fit-to-page]="true"
                [(page)]="page">
              </pdf-viewer>
              <!--
              <div class="pdfOptions">
                <button (click)="nextPage()"><img src="assets/upArrow.png"></button>
                <button (click)="prevPage()"><img src="assets/downArrow.png"></button>
                <span>{{ page }} of {{ pageTotal }}</span>
              </div>
              -->

            </div>
          </div>
        </div>
      </div>
      <button class="button button--primary-yellow" type="button" (click)="submitted=true">Submit</button>
      <div class="divider"></div>
      <button class="button button--secondary" type="button" routerLink="/table"
              routerLinkActive="active">Cancel
      </button>
    </div>
  </div>

  <!--Confirmation Page begins-->

  <div [hidden]="!submitted">
    <h3>You are about to submit the following: </h3>

    <table class="confirm">
      <tr *ngIf="!newForm">
        <th></th>
        <th>Original</th>
        <th>Edited</th>
      </tr>
      <tr>
        <th>Form Type</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.formType !== model.value.formType))}">{{originalForm.formType}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.formType !== model.value.formType))}">{{model.value.formType}}</td>
      </tr>
      <tr>
        <th>Coverage Type</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.coverageType !== model.value.coverageType))}">{{originalForm.coverageType}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.coverageType !== model.value.coverageType))}">{{model.value.coverageType}}</td>
      </tr>
      <tr>
        <th>Coverage State(s)</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.state !== model.value.state))}">{{originalForm.state}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.state !== model.value.state))}">{{model.value.state}}</td>
      </tr>
      <tr>
        <th>Source System</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.sourceSystem !== model.value.sourceSystem))}">{{originalForm.sourceSystem}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.sourceSystem !== model.value.sourceSystem))}">{{model.value.sourceSystem}}</td>
      </tr>
      <tr>
        <th>Form Name</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.name !== model.value.name))}">{{originalForm.name}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.name !== model.value.name))}">{{model.value.name}}</td>
      </tr>
      <tr>
        <th>Form ID</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.formId !== model.value.formId))}">{{originalForm.formId}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.formId !== model.value.formId))}">{{model.value.formId}}</td>
      </tr>
      <tr>
        <th>Form Link</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.link !== model.value.link))}">{{originalForm.link}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.link !== model.value.link))}">{{model.value.link}}</td>
      </tr>
      <tr>
        <th>Form Description</th>
        <td *ngIf="!newForm" [ngClass]="{'editedCell--original': ((!newForm) && (originalForm.description !== model.value.description))}">{{originalForm.description}}</td>
        <td [ngClass]="{'editedCell--new': ((!newForm) && (originalForm.description !== model.value.description))}">{{model.value.description}}</td>
      </tr>
    </table>
    <br> <br> <br>
    <div class="row">
      <button type="submit" *ngIf="newForm" class="button button--primary-yellow">
        Upload to Database
      </button>
      <button type="submit" *ngIf="!newForm" class="button button--primary-yellow">
        Upload Changes
      </button>
      <div class="divider"></div>
      <div *ngIf="newForm">
        <button class="button button--secondary" type="button"
                (click)="submitted=false; submit(); model.reset()">Upload
          and Submit Another Form
        </button>
        <div class="divider"></div>
      </div>
      <button class="button button--tertiary" type="button" routerLink="/table"
              routerLinkActive="active">Cancel
      </button>
    </div>
  </div>

</form>
</body>




<ng-template #loading>
  Loading form...
</ng-template>
