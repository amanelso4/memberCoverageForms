<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bootstrap Example</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body>
<form *ngIf="(form | async) || newForm; else loading" [formGroup]="model" (ngSubmit)="submit()">
  <div class="container-fluid">
    <!--
    -------------------------------------------------Submission Form Page-----------------------------------------------
    -->
    <div [hidden]="submitted">

      <h3>Form Submission</h3>
      <div class="row">
        <br> <br>
                      <!--Column #1: DropDown Menus for formType, coverageType, state, and sourceSystem -->

        <div class="col-lg-4">
          <div class="container">
            <!-- Row for the Form Type dropdown and label -->
            <div class="row">
              <div class="col-lg-4">
                <label for="formType">Form type: </label> <br>
              </div>
              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" required formControlName="formType" id="formType">
                    <option *ngFor="let type of formTypeVar" [value]="type">{{ type }}</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Row for the Coverage Type dropdown and label -->
            <div class="row">
              <div class="col-lg-4">
                <label for="coverageType">Coverage Type: </label>
              </div>

              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" id="coverageType" required formControlName="coverageType"
                          name="coverageType">
                    <option *ngFor="let cType of coverageTypesVar" [value]="cType">{{ cType }}</option>
                  <!--  <option *ngFor="let coverageType of coverageTypes" [value]="coverageType">{{coverageType}}
                    </option> -->
                  </select>
                </div>
              </div>
            </div>

            <!-- Row for the State MULTI-SELECT dropdown and label -->
            <div class="row">
              <div class="col-lg-4">
                <label for="state">Coverage State(s): </label>
              </div>
              <div class="col-lg-8">
                <div class="form-group">

                  <!--<ng-multiselect-dropdown [placeholder]="'States'" [data]="states" formControlName="state"
                                           [settings]="dropdownSettings" (onSelect)="updateState()"
                                           (onSelectAll)="onSelectAll()"
                                           (onDeSelect)="updateState()" (onDeSelectAll)="onDeSelectAll()" name="state"
                                           id="state">
                  </ng-multiselect-dropdown>-->
                  <select multiple formControlName="state" class="form-control" id="state" required style="height: auto" name="state">
                    <option *ngFor="let state of statesVar" [value]="state">{{ state }}</option>
                  </select>
                </div>
              </div>
            </div>

            <!-- Row for the Source System dropdown and label -->
            <div class="row">
              <div class="col-lg-4">
                <label for="sourceSystem">Source System: </label>
              </div>
              <div class="col-lg-8">
                <div class="form-group">
                  <select class="form-control" id="sourceSystem" required formControlName="sourceSystem" name="state">
                    <option *ngFor="let source of sourceVar" [value]="source">{{ source }}</option>
                  </select>
                </div>
              </div>
            </div>
          </div>
        </div>

                                  <!-- Column #2: Text Field Inputs and "View Form" Button -->

        <div class="col-lg-4" style="background-color:white;">

          <!-- Row for Form Name text box and label -->
          <div class="row">
            <div class="col-lg-4">
              <label for="name">Form Name: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="name" required formControlName="name" name="name">
                <!--<div [hidden]="name.valid || name.untouched" class="alert alert-danger">Name is required
              </div>-->
              </div>
            </div>
          </div>

          <!-- Row for Form ID text box and label-->
          <div class="row">
            <div class="col-lg-4">
              <label for="formId">Form ID: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="formId" required formControlName="formId" name="formId">
              </div>
            </div>
          </div>

          <!-- Row for Form Link text box and label along with "View Form" button for PDF Viewer -->
          <div class="row">
            <div class="col-lg-4">
              <label for="link">Form Link: </label>
              <button class="button button--primary-yellow" type="button" (click)="view=true; easterEgg(model.value.name)">View Form</button>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="link" required formControlName="link" name="link">
              </div>
            </div>
          </div>
          <br>

          <!-- Row for Form Description text box and label -->
          <div class="row">
            <div class="col-lg-4">
              <label for="description">Form Description: </label>
            </div>
            <div class="col-lg-8">
              <div class="form-group">
                <input type="text" class="form-control" id="description" required formControlName="description"
                       name="description">
              </div>
            </div>
            <div [hidden]="!egg">
              Hello there my friend, this is amanda.x.nelson. I like to computer program and I am an intern at Sun Life.
              I made this app. This is my EasterEgg. Like it? I bet you do.
            </div>

          </div>

        </div>

                                              <!-- Column #3: PDF Viewer!!!!!! -->

        <div class="col-lg-4" style="background-color:white;">
          <div class="container">
            <div [hidden]="!view">
              <style class="'pdf'" , height="100px"></style>
              <pdf-viewer
                [class]="'pdf'"
                [src]="'https://cors-anywhere.herokuapp.com/' + model.value.link"
                [show-all]="false"
                [original-size]="false"
                [fit-to-page]="true"
                [(page)]="page">
              </pdf-viewer>
              <!--
              <div class="pdfOptions">
                <button (click)="nextPage()"><img src="assets/upArrow.png"></button>
                <button (click)="prevPage()"><img src="assets/downArrow.png"></button>
                <span>{{ page }} of {{ pageTotal }}</span>
              </div>
              -->
            </div>
          </div>
        </div>
      </div> <!-- end of big row that contains three columns -->

      <button class="button button--primary-yellow" type="button" (click)="submitted=true">Submit</button>
      <div class="divider"></div>
      <button class="button button--secondary" type="button" routerLink="/mfm"
              routerLinkActive="active">Cancel
      </button>
    </div> <!-- End of Submission Form Page -->
  </div>

  <!--
  ---------------------------------------------Confirmation Page begins-------------------------------------------------
  -->

  <div [hidden]="!submitted">
    <h3>You are about to submit the following: </h3>

    <table class="confirm">
      <tr>
        <th>Form Type</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.formType === model.value.formType">{{model.value.formType}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.formType !== model.value.formType">
          <p><span class="oldText">{{originalForm.formType}}</span>  {{model.value.formType}}</p>
        </td>
      </tr>
      <tr>
        <th>Coverage Type</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.coverageType === model.value.coverageType">{{model.value.coverageType}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.coverageType !== model.value.coverageType">
          <p><span class="oldText">{{originalForm.coverageType}}</span>  {{model.value.coverageType}}</p>
        </td>
      </tr>
      <tr>
        <th>Coverage State(s)</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.state.toString() === model.value.state.toString()">{{model.value.state}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.state.toString() !== model.value.state.toString()">
          <p><span class="oldText">{{originalForm.state}}</span>  {{model.value.state}}</p>
        </td>
      </tr>
      <tr>
        <th>Source System</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.sourceSystem === model.value.sourceSystem">{{model.value.sourceSystem}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.sourceSystem !== model.value.sourceSystem">
          <p><span class="oldText">{{originalForm.sourceSystem}}</span>  {{model.value.sourceSystem}}</p>
        </td>
      </tr>
      <tr>
        <th>Form Name</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.name === model.value.name">{{model.value.name}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.name !== model.value.name">
          <p><span class="oldText">{{originalForm.name}}</span>  {{model.value.name}}</p>
        </td>
      </tr>
      <tr>
        <th>Form ID</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.formId === model.value.formId">{{model.value.formId}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.formId !== model.value.formId">
          <p><span class="oldText">{{originalForm.formId}}</span>  {{model.value.formId}}</p>
        </td>
      </tr>
      <tr>
        <th>Form Link</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.link === model.value.link">{{model.value.link}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.link !== model.value.link">
          <p><span class="oldText">{{originalForm.link}}</span>  {{model.value.link}}</p>
        </td>
      </tr>
      <tr>
        <th>Form Description</th>
        <!--Field not Changed-->
        <td *ngIf="originalForm.description === model.value.description">{{model.value.description}}</td>
        <!--Field Changed-->
        <td class="comparison" *ngIf="originalForm.description !== model.value.description">
          <p style="height: 14px"><span class="oldText">{{originalForm.description}}</span>  {{model.value.description}}</p>
        </td>
      </tr>
      <!--<tr *ngIf="!newForm">
        <td class="comparison" style="text-align: center" colspan="2"><p style="height: 14px"><span class="oldText">Original Text</span>  Edited Text</p>
        </td>
      </tr>-->
    </table>
    <br> <br> <br>
    <div class="row">
      <button type="submit" *ngIf="newForm" class="button button--primary-yellow">
        Upload to Database
      </button>
      <button type="submit" *ngIf="!newForm" class="button button--primary-yellow">
        Upload Changes
      </button>
      <div class="divider"></div>
      <div *ngIf="newForm">
        <button class="button button--secondary" type="button"
                (click)="submitted=false; submit(); model.reset()">Upload
          and Submit Another Form
        </button>
        <div class="divider"></div>
      </div>
      <button class="button button--tertiary" type="button" routerLink="/mfm"
              routerLinkActive="active">Cancel
      </button>
    </div>
  </div>

</form>
</body>

<ng-template #loading>
  Loading form...
</ng-template>
